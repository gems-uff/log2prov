expression    := IfThenExpr 
			   | SubstringExpr 
			   | ContainsExpr 
			   | ReplaceExpr 
			   | TestRegexpExpr 
			   | MatchExpr 
               | BooleanExpr 
			   | AssignExpr 
			   | StatementExpr 
			   | StringLiteral
			   | NumberLiteral
			   | $identifier   
              
IfThenExpr    := BooleanExpr ? expression | expression
               | BooleanExpr ? expression 
                
BooleanExpr   := TestRegexpExpr 
               | ContainsExpr 
			   | true 
			   | false

TegexpExpr    := testRegexp(literal, regexp)

ContainsExpr  := stringLiteral.contains(stringLiteral)

AssignExpr    := identifier = expression
              
ReplaceExpr   := stringLiteral.replace(stringLiteral, stringLiteral) 
               | ReplaceExpr.replace(stringLiteral, stringLiteral)
              
MatchExpr     := stringLiteral.match(stringLiteral) 
               | MatchExpr.match(stringLiteral)
			   
SubstringExpr := stringLiteral.substring(numberLiteral, numberLiteral) 
               | SubstringExpr.substring(numberLiteral, numberLiteral)


StatementExpr := actedOnBehalfOf($identifier, $identifier) 
               | wasAttributedTo($identifier, $identifier) 
			   | wasDerivedFrom($identifier, $identifier) 
			   | wasGeneratedBy($identifier, $identifier) 
			   | used($identifier, $identifier) 
			   | wasAssociatedWith($identifier, $identifier)

identifier    := [A-Za-z][A-Za-z0-9]*

numberLiteral := [0-9]+
              
stringLiteral := ".*"

literal       := $identifier | stringLiteral | numberLiteral
